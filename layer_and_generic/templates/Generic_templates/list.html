{% extends "LAG/base.html" %}

{% block body %}
<h1>{{ table_name }} List</h1>
<a href="{% url create_url %}">Create New Record</a>
<ul>
  {% for obj in object_list %}
    <li>
      <a href="{% url detail_url obj.pk %}">{{ obj }}</a>
      | <a href="{% url update_url obj.pk %}">Edit</a>
      | <button onclick="confirmDelete({{ obj.pk }}, '{{ obj|escapejs }}'{% if obj.image_field or obj.file_field %}, true{% else %}, false{% endif %})" style="background: none; border: none; color: blue; text-decoration: underline; cursor: pointer;">Delete</button>
    </li>
  {% endfor %}
</ul>

<a href="{% url 'home_layer_and_generic' %}">Back to Home</a>

<!-- Hidden form for deletion -->
<form id="deleteForm" method="post" style="display: none;">
  {% csrf_token %}
</form>

<script>
function confirmDelete(objectId, objectName, hasFiles) {
    let message = 'Are you sure you want to delete "' + objectName + '"?';
    
    if (hasFiles) {
        message += '\n\nWarning: This record has associated files that will also be deleted.';
    }
    
    if (confirm(message)) {
        const form = document.getElementById('deleteForm');
        form.action = "{% url delete_url 0 %}".replace('0', objectId);
        form.submit();
    }
}
</script>

{% endblock %}